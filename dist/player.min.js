/* thumbsPlayer v1.0.8 */
!function(a,b,c){a[c]=function(a){var c=[],d=!1,e=.8,f={streaming:"Currently streaming...",paused:"Click play to stream."};this.el=null,this.playing=!1,this.flash=null,this.currentTrack=0;var g={play:null,pause:null,playPause:null,scrubber:null,timeBar:null,streamMsg:null,trackTitle:null,volumeUp:null,volumeDown:null,volume:null,trackAhead:null,trackBack:null};return this.enableLog=!1,this.log=function(){"undefined"!=typeof console&&this.enableLog&&console.log(arguments)},this.setTimer=function(){var a=this.getTrack();d&&(g.timeBar.children(".currentTime").html(this.meaningfulTime(a.currentTime)),g.timeBar.children(".totalTime").html(this.meaningfulTime(a.duration)))},this.playAudio=function(){this.playing=!0,this.updateMsg(),this.el.css({"-webkit-animation-play-state":"running","-moz-animation-play-state":"running","-ms-animation-play-state":"running","-o-animation-play-state":"running"}),this.getTrack().play(),this.setVolume(e)},this.pauseAudio=function(){this.playing=!1,this.updateMsg(),this.el.css({"-webkit-animation-play-state":"paused","-moz-animation-play-state":"paused","-ms-animation-play-state":"paused","-o-animation-play-state":"paused"}),this.getTrack().pause()},this.playOrPauseAudio=function(){this.playing?this.pauseAudio():this.playAudio()},this.updateMsg=function(){g.streamMsg&&g.streamMsg.html(this.playing?f.streaming:f.paused)},this.updateTitle=function(){var a=this.getTrack(),b=[];g.trackTitle&&"undefined"!=typeof a.trackInfo&&("undefined"!=typeof a.trackInfo.artist&&b.push(a.trackInfo.artist),"undefined"!=typeof a.trackInfo.title&&b.push('"'+a.trackInfo.title+'"'),"undefined"!=typeof a.trackInfo.album&&b.push("<i>"+a.trackInfo.album+"</i>"),g.trackTitle.html(b.join(" - ")))},this.scrub=function(a){var b,c=g.scrubber.offset(),d=Math.floor((a.pageX-c.left)/g.scrubber.width()*100);return d>100?d=100:0>d&&(d=0),g.scrubber.children("div").css({width:d+"%"}),b=Math.floor(audio.duration*(d/100)),this.setCurrentTimer(b),b},this.seekAudio=function(a){var b=this.getTrack();a>b.duration?a=b.duration:0>a&&(a=0),"function"==typeof b.seek?b.seek(a):b.currentTime=a,d=!0},this.checkBuffering=function(){if(g.playPause){var a=this.getTrack();this.playing&&(a.buffered.start(0)>=a.currentTime||a.buffered.end(0)<=a.currentTime)?g.playPause.removeClass("play").removeClass("pause"):this.playing?g.playPause.removeClass("play").addClass("pause"):g.playPause.addClass("play").removeClass("pause")}},this.updateScrubber=function(){var a=this.getTrack();if(d){var b=Math.floor(a.currentTime/a.duration*100);g.scrubber.children("div").css({width:b+"%"})}},this.setCurrentTimer=function(a){g.timeBar.children(".currentTime").html(this.meaningfulTime(a))},this.meaningfulTime=function(a){var b=0,c=0,d=0;return a>0&&(d=Math.round(a%60)),a>=60&&(c=Math.floor(a/60%60)),a>=3600&&(b=Math.floor(a/3600%3600)),10>d&&(d="0"+d),10>c&&(c="0"+c),b+":"+c+":"+d},this.meaningfulToSeconds=function(a){for(var b=a.split(":").reverse(),c=0,d=0;d<b.length;d++)0===d?c+=parseInt(b[d]):1==d?c+=60*parseInt(b[d]):2==d&&(c+=3600*parseInt(b[d]));return c},this.adjustVolume=function(a){return(Math.exp(a)-1)/(Math.E-1)},this.setVolume=function(a){a>1?a=1:0>a&&(a=0),this.log("volume: "+a),e=a,this.playing&&(this.getTrack().volume=this.adjustVolume(a),this.log("real volume: "+this.getTrack().volume),"function"==typeof this.getTrack().setVolume&&this.getTrack().setVolume())},this.stepVolume=function(a){var b=.1*a;this.setVolume(e+b)},this.changeTrack=function(a){"undefined"!=typeof c[a]&&(this.playing?(this.pauseAudio(),this.seekAudio(0),this.currentTrack=a,this.seekAudio(0),this.playAudio()):this.playAudio(),this.setTrackButtons(),this.updateTitle())},this.getTrack=function(){return c[this.currentTrack]},this.setTrackButtons=function(){g.trackAhead&&(this.currentTrack>=c.length-1?g.trackAhead.addClass("disabled"):g.trackAhead.removeClass("disabled")),g.trackBack&&(this.currentTrack<=0?g.trackBack.addClass("disabled"):g.trackBack.removeClass("disabled"))},this.jPlayerLoaded=!1,this.jPlayerBridge=function(a,c){var d=this,e=!1,f=b(a).children("source");this.src=f.attr("src"),this.runtime=f.data("runtime"),this.player=b("<div />").addClass("jplayer"),this.duration=this.runtime?this.runtime:0,this.currentTime=0,this.bufferedStart=0,this.bufferedEnd=0,b(c.el).append(this.player),this.player.jPlayer({ready:function(){d.init(),c.addListeners(d)},swfPath:"../player/jplayer/jplayer.swf",solution:"html, flash"}),this.addEventListener=function(a,c){d.player.bind(b.jPlayer.event[a],c)},this.init=function(){e=!0,d.addEventListener("timeupdate",function(a){d.currentTime=a.jPlayer.status.currentTime}),d.addEventListener("progress",function(a){(!d.runtime||a.jPlayer.status.duration>d.duration)&&(d.duration=a.jPlayer.status.duration),d.bufferedEnd=a.jPlayer.status.duration}),d.player.jPlayer("setMedia",{mp3:d.src})},this.play=function(a){return e?(d.player.jPlayer("play",a),!0):!1},this.pause=function(a){"undefined"!=typeof a?d.player.jPlayer("pause",a):d.player.jPlayer("pause")},this.seek=function(a){c.playing?d.play(a):d.pause(a)},this.buffered={start:function(){return d.bufferedStart},end:function(){return d.bufferedEnd}},this.volume=null,this.setVolume=function(){d.player.jPlayer("volume",this.volume)}},this.addListeners=function(a){var b=this;a.addEventListener("durationchange",function(){b.setTimer()}),a.addEventListener("timeupdate",function(){b.setTimer(),b.updateScrubber()}),a.addEventListener("play",function(){b.log("play"),g.playPause.addClass("play").removeClass("pause")}),a.addEventListener("pause",function(){b.log("pause"),g.playPause.removeClass("pause").addClass("play")}),a.addEventListener("ended",function(){b.pauseAudio()}),a.addEventListener("loadedmetadata",function(){if(window.location.hash){for(var a=window.location.hash.substr(1).split("|"),c=!1,d=0;d<a.length;d++)"playing"==a[d]?c=!0:(seconds=b.meaningfulToSeconds(a[d]),b.seekAudio(seconds));c&&b.playAudio()}})},this.applySettings=function(a){if(this.el=b(a.selector),!this.el.length)return!1;if("undefined"!=typeof a.logging&&(this.enableLog=a.logging),"undefined"!=typeof a.messages)for(var d in a.messages)a.messages.hasOwnProperty(d)&&(f[d]=f[d]);"undefined"!=typeof a.initVolume&&(this.volume=a.initVolume);var e;if(this.el.find("audio").length)c=this.el.find("audio");else if("undefined"!=typeof a.audio&&a.audio.length)for(e=0;e<a.audio.length;e++){var g=new Audio;g.src=a.audio[e].file,"undefined"!=typeof a.audio[e].type&&(g.type=a.audio[e].type),"undefined"!=typeof a.audio[e].trackInfo&&(g.trackInfo=a.audio[e].trackInfo),g.load(),c.push(g)}var h;for(e=0;e<c.length;e++)if(h=c[e].canPlayType(c[e].type),"maybe"==h||"probably"==h)this.addListeners(c[e]);else{var i=new this.jPlayerBridge(c[e],this);c[e]=i}return!0},function(a,c){if(c.applySettings(a)){if(c.currentTrack=0,c.el.find(".controlSingle").length&&(g.playPause=c.el.find(".controlSingle"),g.playPause.addClass("play"),g.playPause.click(function(){return c.playOrPauseAudio(c),!1})),c.el.find(".scrubber").length){g.scrubber=c.el.find(".scrubber");var e=b("<div />").css({width:"0%"}).appendTo(g.scrubber);b("<span />").appendTo(e),d=!0;var f=0;g.scrubber.bind("mousedown",function(a){c.log("scrub: click"),d=!1,f=c.scrub(a),g.scrubber.bind("mousemove",function(a){c.log("scrub: scrub scrub"),f=c.scrub(a)}),g.scrubber.bind("mouseleave",function(){c.log("scrub: leave (play)"),c.seekAudio(f),g.scrubber.unbind("mousemove").unbind("mouseleave").unbind("mouseup")}),g.scrubber.bind("mouseup",function(){c.log("scrub: let go (play)"),c.seekAudio(f),g.scrubber.unbind("mousemove").unbind("mouseleave").unbind("mouseup")})})}c.el.find(".timeBar").length&&(g.timeBar=c.el.find(".timeBar")),c.el.find(".streamMsg").length&&(g.streamMsg=c.el.find(".streamMsg"),c.updateMsg()),c.el.find(".volumeUp").length&&(g.volumeUp=c.el.find(".volumeUp"),g.volumeUp.bind("click",function(){c.log("click: volume up"),c.stepVolume(1)})),c.el.find(".volumeDown").length&&(g.volumeDown=c.el.find(".volumeDown"),g.volumeDown.bind("click",function(){c.log("click: volume down"),c.stepVolume(-1)})),c.el.find(".trackAhead").length&&(g.trackAhead=c.el.find(".trackAhead"),g.trackAhead.bind("click",function(){c.log("click: skip track"),c.changeTrack(c.currentTrack+1)})),c.el.find(".trackBack").length&&(g.trackBack=c.el.find(".trackBack"),g.trackBack.bind("click",function(){c.log("click: back track"),c.changeTrack(c.currentTrack-1)})),c.el.find(".audioTitle").length&&(g.trackTitle=c.el.find(".audioTitle"),c.updateTitle()),c.el.find(".volume").length&&(g.volume=c.el.find(".volume")),c.playerInt=setInterval(function(){c.checkBuffering()},100),c.setTrackButtons(),"undefined"!=typeof a.autoPlay&&a.autoPlay&&c.playAudio()}}(a,this),{}}}(this,jQuery,"ThumbsPlayer");